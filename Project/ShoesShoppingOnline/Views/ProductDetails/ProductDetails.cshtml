@model ShoesShoppingOnline.Models.DataModel.ProductModel
@{
    ViewData["Title"] = "ProductDetails";
    Layout = "~/Views/Shared/_Layout.cshtml";
    ShoesShoppingOnline.Models.DataModel.PRN211_HS160974Context context = new ShoesShoppingOnline.Models.DataModel.PRN211_HS160974Context();
}

<div class="Single-product-location home2">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="location">
                    <ul>
                        <li><a href="@Url.Action("Index","Home")" title="go to homepage">Home<span>/</span></a>  </li>
                        <li><strong> @Model.Name</strong></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- single product area end -->
<!-- single product details start -->
<div class="single-product-details">
    <div class="container">
        <div class="row">
            <div class="col-sm-6">
                <div class="single-product-img tab-content">
                    <div class="single-pro-main-image tab-pane active" id="pro-large-img-1">
                        <a href="#"><img class="optima_zoom" src="@Model.Image" data-zoom-image="@Model.Image" alt="optima" /></a>
                    </div>
                    <div class="single-pro-main-image tab-pane" id="pro-large-img-2">
                        <a href="#"><img class="optima_zoom" src="~/dataclient/img/product/2.png" data-zoom-image="img/product/2.png" alt="optima" /></a>
                    </div>
                    <div class="single-pro-main-image tab-pane" id="pro-large-img-3">
                        <a href="#"><img class="optima_zoom" src="~/dataclient/img/product/8.png" data-zoom-image="img/product/8.png" alt="optima" /></a>
                    </div>
                    <div class="single-pro-main-image tab-pane" id="pro-large-img-4">
                        <a href="#"><img class="optima_zoom" src="~/dataclient/img/product/1.png" data-zoom-image="img/product/1.png" alt="optima" /></a>
                    </div>
                    <div class="single-pro-main-image tab-pane" id="pro-large-img-5">
                        <a href="#"><img class="optima_zoom" src="~/dataclient/img/product/9.png" data-zoom-image="img/product/9.png" alt="optima" /></a>
                    </div>
                </div>
                <div class="product-page-slider">
                    <div class="single-product-slider">
                        <a href="#pro-large-img-1" data-toggle="tab">
                            <img src="~/dataclient/img/product/28.png" alt="">
                        </a>
                    </div>
                    <div class="single-product-slider">
                        <a href="#pro-large-img-2" data-toggle="tab">
                            <img src="~/dataclient/img/product/30.png" alt="">
                        </a>
                    </div>
                    <div class="single-product-slider">
                        <a href="#pro-large-img-3" data-toggle="tab">
                            <img src="~/dataclient/img/product/29.png" alt="">
                        </a>
                    </div>
                    <div class="single-product-slider">
                        <a href="#pro-large-img-4" data-toggle="tab">
                            <img src="~/dataclient/img/product/31.png" alt="">
                        </a>
                    </div>
                    <div class="single-product-slider">
                        <a href="#pro-large-img-5" data-toggle="tab">
                            <img src="~/dataclient/img/product/29.png" alt="">
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="single-product-details">
                    <a href="#" class="product-name">@Model.Name</a>
                    <div class="list-product-info">
                        <div class="price-rating">
                            <div class="ratings">
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star-half-o"></i>
                                <a href="#" class="review">1 Review(s)</a>
                                <a href="#" class="add-review">Add Your Review</a>
                            </div>
                        </div>
                    </div>
                    <div class="avalable">
                        <p>Availability:<span> In stock</span></p>
                    </div>
                    <div class="item-price">
                        <span>@Model.Price</span>
                    </div>
                    <div class="single-product-info">
                        <p>@Model.Description</p>
                        <div class="share">
                            <img src="~/dataclient/img/product/share.png" alt="">
                        </div>
                    </div>
                    <div class="action">
                        <ul class="add-to-links">
                            <li>
                                <a href="#">
                                    <i class="fa fa-heart"></i>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <i class="fa fa-refresh"></i>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <i class="fa fa-envelope"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="select-catagory">
                        <div class="size-select">
                            <label class="required">
                                <em>*</em> Size
                            </label>
                            <div class="input-box">
                                <select id="sizeId">
                                    <option value="">-- Please Select --</option>
                                    @foreach(var size in context.SizeHs160974s.Where(s => s.Pid == Model.ProductId).ToList())
                                    {
                                        <option value="@size.SizeId" data-quantity="@size.Quantity">@size.SizeName</option>
                                    }
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="cart-item">
                        <div class="single-cart">
                            <div class="cart-plus-minus">
                                <div class="dec qtybutton"><</div>
                                <label for="quantityInput">Qty: </label>
                                <input id="quantityInput" class="cart-plus-minus-box" type="text" name="qtybutton" value="0" data-max-quantity="">
                                <div class="inc qtybutton">></div>
                            </div>
                            <a id="addToCartLink" href="@Url.Action("Cart","AddToCart")?Pid=@Model.ProductId&sizeID=" class="cart-btn">Add to cart</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section AddToCart{
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var sizeId = document.getElementById('sizeId');
            var quantityInput = document.getElementById('quantityInput');
            var addToCartLink = document.getElementById('addToCartLink');
            var plusButton = document.querySelector('.inc.qtybutton');
            var minusButton = document.querySelector('.dec.qtybutton');
            var selectedSizeId = "";

            sizeId.addEventListener('change', function () {
                selectedSizeId = this.value;
                updateAddToCartLink();
            });

            plusButton.addEventListener('click', function (event) {
                event.preventDefault();
                var currentValue = parseInt(quantityInput.value);
                var maxQuantity = parseInt(sizeId.options[sizeId.selectedIndex].getAttribute('data-quantity'));
                var newValue = currentValue + 1;
                if (newValue <= maxQuantity) {
                    quantityInput.value = newValue;
                    updateAddToCartLink(newValue);
                }
            });

            minusButton.addEventListener('click', function (event) {
                event.preventDefault();
                var currentValue = parseInt(quantityInput.value);
                var newValue = currentValue - 1;
                if (newValue >= 0) {
                    quantityInput.value = newValue;
                    updateAddToCartLink(newValue);
                }
            });

            addToCartLink.addEventListener('click', function (event) {
                var quantityValue = parseInt(quantityInput.value);
                var maxQuantity = parseInt(sizeId.options[sizeId.selectedIndex].getAttribute('data-quantity'));
                if (quantityValue === 0) {
                    event.preventDefault();
                    alert("Số lượng sản phẩm phải lớn hơn 0");
                } else if (quantityValue > maxQuantity) {
                    event.preventDefault();
                    alert("Số lượng sản phẩm không khả dụng. Vui lòng chọn số lượng nhỏ hơn hoặc bằng " + maxQuantity);
                }
            });

            function updateAddToCartLink() {
                var quantityValue = quantityInput.value;
                addToCartLink.href = '@Url.Action("Cart","AddToCart")?Pid=' + '@Model.ProductId' + '&sizeID=' + selectedSizeId + '&quantity=' + quantityValue;
                var maxQuantity = parseInt(sizeId.options[sizeId.selectedIndex].getAttribute('data-quantity'));
                quantityInput.setAttribute('data-max-quantity', maxQuantity);
            }
        });

    </script>
}
